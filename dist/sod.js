sod_locale.en={incidents:{label:"Incidentes"},casualties:{label:"Casualties"},loading:{label:"loading"},menu:{info:"info"},info:{headline:"It's not only the group of people or the city or the block that were attacked who suffer, this leaves an scar among everyone and if we don't pay attention to those little places where media don't report, then those feelings will start spreading faster than media can catch and it will be worst.",related:"This is a timeline related to terrorism attacks since 1970. The data used to display the info is from <a href='https://www.start.umd.edu'>START's</a> <a href='https://www.start.umd.edu/gtd/'>Global Database Terrorism</a> project.",footnote:"If you want to report a bug or suggest an idea, or a PR <a href='https://github.com/diablourbano/sod'>this is the repo</a>."}},moment.locale("es",{months:"Enero_Febrero_Marzo_Abril_Mayo_Junio_Julio_Agosto_Septiembre_Octubre_Noviembre_Diciembre".split("_"),monthsShort:"ene_feb_mars_abr_may_jun_jul_ago_sept_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom_lun_mar_mier_jue._vie._sab.".split("_"),weekdaysMin:"Do_Lu_Ma_Mi_Ju_Vi_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Hoy es] LT",nextDay:"[Manana] LT",nextWeek:"dddd [de] LT",lastDay:"[Ayer] LT",lastWeek:"dddd [pasado] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"une année",yy:"%d années"},ordinalParse:/\d{1,2}/,ordinal:function(t){return t},meridiemParse:/AM|PM/,isPM:function(t){return"P"===t.charAt(0)},meridiem:function(t,e,n){return t<12?"AM":"PM"},week:{dow:1,doy:4}}),sod_locale.es={incidents:{label:"Incidentes"},casualties:{label:"Víctimas"},loading:{label:"cargando"},menu:{info:"info"},info:{headline:"No es solo el grupo de gente, o la ciudad o el barrio que fue atacado quien sufre, aquel ataque deja un daño permanente en todos y si no damos la atención necesaria, la misma que no reportan los medios, entonces ese daño se esparcirá más rápido y eso será peor.",related:"Esta es una línea de tiempo relacionada a los ataques terroristas sucedidos desde 1970. La información le pertenece al proyecto <a href='https://www.start.umd.edu/gtd/'>Global Database Terrorism</a> de <a href='https://www.start.umd.edu'>START</a>",footnote:"Si deseas reportar un error o sugerir una idea, o hacer un PR <a href='https://github.com/diablourbano/sod'>acá está el repo</a>."}},moment.locale("fr",{months:"Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Août_Septembre_Octobre_Novembre_Décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"une année",yy:"%d années"},ordinalParse:/\d{1,2}(er|ème)/,ordinal:function(t){var e;return e=1===t?"er":"ème",t+e},meridiemParse:/PD|MD/,isPM:function(t){return"M"===t.charAt(0)},meridiem:function(t,e,n){return t<12?"PD":"MD"},week:{dow:1,doy:4}}),sod_locale.fr={incidents:{label:"Incidentes"},casualties:{label:"Victimes"},loading:{label:"chargement"},menu:{info:"info"},info:{headline:"Ce n'est pas seulement le groupe de personnes ou la ville ou le bloc qui ont été attaqués qui souffrent, cela laisse une cicatrice parmi tous et si nous ne faisons pas attention à ces petits endroits où les médias ne rapportent pas, alors ces sentiments vont commencer à se répandre Plus vite que les médias peuvent attraper et il sera pire.",related:"Il s'agit d'une chronologie liée aux attentats terroristes depuis 1970. Les données utilisées pour afficher l'information proviennent du projet <a href='https://www.start.umd.edu'>START's</a> <a href='https://www.start.umd.edu/gtd/'>Global Database Terrorism</a>",footnote:"Si vous voulez signaler un bogue ou suggérer une idée, ou un RP, <a href='https://github.com/diablourbano/sod'>c'est le repo</a>."}};var LocaleUI;LocaleUI=function(){function t(t,r){e=r,n(t)}var e,n;return e=null,n=function(t){return moment.locale(t)},$(".lang").on("click",function(t){var r;return r=moment.locale(),n(t.target.text),$(".language .selected .lang-to-use").text(moment.locale()),$(this).text(r),$(".language .lang-options").toggleClass("visible"),e.shouldTranslate(r)}),$(".language .selected").on("click",function(){return $(".language .lang-options").toggleClass("visible")}),t}();var Utils;Utils=function(){function t(){}return t.prototype.height=window.innerHeight,t.prototype.width=window.innerWidth,t.prototype.timelineHeight=350,t.prototype.windowRatio=function(){return window.innerWidth/window.innerHeight},t.prototype.sizeStyles=function(t,e){return null==t&&(t=this.width),null==e&&(e=this.height),"auto"!==t&&(t+="px"),"auto"!==e&&(e+="px"),["width:"+t,"height:"+e].join(";")},t.prototype.monthIndex=function(t){return moment.months().indexOf(t)+1},t.prototype.getFormattedDate=function(t,e){var n;return"years"===e&&(n="Y"),"months"===e&&(n="MMMM"),"days"===e&&(n="Do"),moment(t).format(n)},t.prototype.printLog=function(t){},t}();var UrlManager;UrlManager=function(){function t(){}var e,n,r,i,o,a;return a=new Utils,i={years:null,months:null,days:null},r=function(t){switch(parseInt(t[1])){case 1:case 3:case 5:case 7:case 8:case 10:case 12:return 31;case 2:return _.endsWith(t[0],"00")&&parseInt(t[0])%400===0||parseInt(t[0])%4===0?28:29;default:return 30}},e=function(t){var e;return e=moment().year(parseInt(t[0])),t[1]&&""!==t[1]&&e.month(parseInt(t[1])-1),t[2]&&""!==t[2]&&e.date(parseInt(t[2])),e.format("Y MMMM Do").split(" ")},n=function(t){var e,n,i,o,a;return n=t.split("/"),e=[],null!==n[0].match(/^\d{4}/)&&1970<=(i=parseInt(n[0]))&&i<=2014?(e[0]=n[0],void 0!==n[1]&&null!==n[1].match(/^\d{1,2}$/)&&1<=(o=parseInt(n[1]))&&o<=12&&(1===n[1].length&&(n[1]="0"+n[1]),e[1]=n[1],void 0!==n[2]&&null!==n[2].match(/^\d{1,2}$/)&&1<=(a=parseInt(n[2]))&&a<=r(n)&&(1===n[2].length&&(n[2]="0"+n[2]),e[2]=n[2])),e):null},o=function(){return window.location.href="#/"+_.filter(i,function(t){return null!==t&&""!==t}).join("/")},t.prototype.loadTimelineOnDate=function(){var t,r,a,s;return r=location.hash.replace("#/",""),0===r.length?null:(t=n(r),i=_.zipObject(_.keys(i),t),o(),s=e(t),a=i,a.years=s[0],a.months&&""!==a.months&&(a.months=s[1]),a.days&&""!==a.days&&(a.days=s[2]),a)},t.prototype.goToDate=function(t,e){return e&&("months"===t&&(e=(moment().month(e.toLowerCase()).month()+1).toString()),1===e.length&&(e="0"+e)),i[t]=e,o()},t.prototype.urlHash=function(){return window.location.hash.replace(/(^#\/|\/$)/g,"").split("/")},t}();var EventsManager;EventsManager=function(){function t(t){v=t}var e,n,r,i,o,a,s,l,u,c,d,p,h,f,g,m,y,x,v,w;return l=/(st|nd|rd|th|er|ème)/,c=[],i="years",o=["years","months","days"],x={},h={years:null,months:"January",days:"01"},a=[],v=null,w=new Utils,d=d3.time.format("%Y-%m-%d").parse,y=function(t,e){var n,r,i;return n=e.shift(),i=w.monthIndex(n),i>0&&(n=i),n.length>0&&null!==(r=n.match(/^\d{1,2}\D{2,3}$/))&&(n=parseInt(n.replace(/\D{2,3}$/,""))),void 0!==t[n]?0===e.length?t[n]:y(t[n],e):null},e=function(){var t,e;return e=_.values(h),e[2]=n(e[2]),t=e.slice(0,o.indexOf(i)+1),y(x,t)},m=function(t,e){return e&&1===e.length&&(e="0"+e),h[t]=e},f=function(t){var e;return t=t.trim(),e=$(".graph-slot p.selected-date span").text().trim(),""!==e&&(a=e.split(" ")),null!==t.match(/^\d{4}$/)?a[0]=t:null!==t.match(/^\D+$/)?a[1]=t:null!==t.match(/^\d{1,2}\D{2,3}$/)?a[2]=t:void 0},g=function(t){var e;if("days"!==i)return e=o.indexOf(t),i=o[e+1]},p=function(){return m("years",null),m("months","January"),m("days","01")},r=function(t){return null!==t.match(l)&&"days"===i&&(t=t.replace(l,"")),t},n=function(t){var e;return e=parseInt(t),moment.localeData().ordinal(e)},s=function(t){var e,n;return e=[],t.length>0&&(t[0]&&e.push(a[0]),t[1]&&(n=t[1],n&&(n=w.monthIndex(n).toString(),1===n.length&&(n="0"+n),e.push(n)))),e},u=function(t){var e;return!_.isEmpty(x)&&(1===t.length?void 0!==x[t[0]][1]:2!==t.length||(e=w.monthIndex(t[1]),void 0!==x[t[0]][e]["1st"]))},t.prototype.getDateTextFragments=function(){return a},t.prototype.addListener=function(t){if(c.indexOf(t)===-1)return c.push(t)},t.prototype.shouldHighlight=function(t){var n,o,a,s,l,u,d;for(n=_.map(t,function(t){return t.replace("time-","")}),a=r(n[0]),m(i,a),o=e(),d=[],s=0,l=c.length;s<l;s++)u=c[s],d.push(u.highlight(n,o));return d},t.prototype.shouldUnhighlight=function(t){var n,o,a,s,l,u,d;for(n=_.map(t,function(t){return t.replace("time-","")}),a=r(n[0]),m(i,a),o=e(),d=[],s=0,l=c.length;s<l;s++)u=c[s],d.push(u.unhighlight(n,o));return d},t.prototype.shouldFixDate=function(t,n,s,l){var u,d,y,x,w,L,D,$,b,S,M,C;if(null==s&&(s=null),null==l&&(l=!0),y=a.indexOf(t),y>-1){for(w=[],i=o[y],x=L=C=y;C<=2?L<=2:L>=2;x=C<=2?++L:--L)a[x]=null,0===x&&p(),x<2&&w.push(o[x+1]),v.goToDate(_.keys(h)[x],null);for(D=0,b=c.length;D<b;D++)M=c[D],M.unfixHighlight(n),M.remove(w)}else{if(d=r(t),m(n,d),u=e(),!u)return;for(f(t),$=0,S=c.length;$<S;$++)M=c[$],M.unhighlight(t,u),M.fixHighlight(n,u);l===!0&&v.goToDate(n,d),g(n)}return this.shouldExploreDate(s)},t.prototype.shouldExploreDate=function(t){return this.getData(function(){var t,e,n,r;for(r=[],t=0,e=c.length;t<e;t++)n=c[t],r.push(n.exploreDate());return r},t)},t.prototype.shouldRender=function(){var t;return t=v.loadTimelineOnDate(),this.getData(function(){var t,e,n,r;for(r=[],t=0,e=c.length;t<e;t++)n=c[t],r.push(n.render());return r},t)},t.prototype.shouldRedraw=function(){var t,e,n,r;for(r=[],t=0,e=c.length;t<e;t++)n=c[t],r.push(n.redraw());return r},t.prototype.shouldTranslate=function(t){var e,n,r,i,o,a;for(o=moment(_.values(h).join("-"),"YYYY-MMMM-DD",t),i=moment.months()[o.month()],f(i),m("months",i),a=[],e=0,n=c.length;e<n;e++)r=c[e],a.push(r.translate());return a},t.prototype.shouldUnhighlightBasedOnCountry=function(t){var e,n,r,s,l,u,d,p,h;for(n=t[1],l=a.slice(0,o.indexOf(i)),s=_.filter(a,function(t){return null!=t}),e=y(x,s),r=_.find(e.countries,function(t){return t.country===n}),h=[],u=0,d=c.length;u<d;u++)p=c[u],h.push(p.unhighlightByCountry(i,r));return h},t.prototype.shouldHighlightBasedOnCountry=function(t){var e,n,r,s,l,u,d,p,h,f,g,m;for(n=t[1],u=a.slice(0,o.indexOf(i)),l=_.filter(a,function(t){return null!=t}),e=y(x,l),s=_.find(e.countries,function(t){return t.country===n}),d=0,h=t.length;d<h;d++)r=t[d],u.unshift(r);for(m=[],p=0,f=c.length;p<f;p++)g=c[p],m.push(g.highlightByCountry(u,s));return m},t.prototype.isLoading=function(){var t,e,n,r;for(r=[],t=0,e=c.length;t<e;t++)n=c[t],r.push(n.isLoading());return r},t.prototype.endLoading=function(){var t,e,n,r;for(r=[],t=0,e=c.length;t<e;t++)n=c[t],r.push(n.endLoading());return r},t.prototype.getDataSet=function(){var t,e,n;return null===h.years?_.values(x):(e=_.values(h).slice(0,o.indexOf(i)),n=y(x,e),t=_.pickBy(n,function(t,e){var n;return n=["date","casualties","incidents","countries"],_.indexOf(n,e)===-1}),_.values(t))},t.prototype.getDateState=function(){return i},t.prototype.getData=function(t,e){var n,o;return n=_.filter(a,function(t){return null!==t}),3===n.length||u(n)?(t(),e&&!a[2]&&e[i]?this.shouldFixDate(e[i],i,e,!1):void 0):(this.isLoading(),o=s(n),d3.json(cors_origin+"/"+o.join("/"),function(n){return function(s,l){return s?printError(s):(l.forEach(function(t){var e,n;if(t.date=d(t.date),e=w.getFormattedDate(t.date,i),"years"===i&&(x[e]=t),"months"===i&&(n=w.monthIndex(e),x[o[0]][n]=t),"days"===i)return n=w.monthIndex(a[1]),x[o[0]][n][r(e)]=t}),t(),_.delay(function(){return n.endLoading()},1e3),e&&!a[2]&&e[i]?n.shouldFixDate(e[i],i,e,!1):void 0)}}(this)))},t}();var Transitions;Transitions=function(){function t(t){l=t,r(),f(l.getDateState())}var e,n,r,i,o,a,s,l,u,c,d,p,h,f,g,m,y;return y=new Utils,l=null,p=0,o=["years","months","days"],i=null,n=function(){var t,e,n;return n=parseInt($(".dates-container").css("height").replace("px","")),e=n-p,p=n,t=parseInt($(".graph-slot").css("bottom").replace("px","")),$(".graph-slot").css("bottom",t+e+"px")},e=function(){var t;if(t=parseInt($(".dates-container").css("height").replace("px","")),t>=10)return $(".graph-slot").css("bottom",t+"px")},h=function(){var t;return t=parseInt($(".dates-container").css("height").replace("px","")),$(".graph-slot").css("bottom",t+"px")},d=function(){var t;if("days"!==i)return t=o.indexOf(i),o[t+1]},r=function(){return $(".timeaxis").perfectScrollbar({theme:"sod",suppressScrollY:!0}),$(".timeline-container").perfectScrollbar({suppressScrollY:!0})},f=function(t){return i=t,$(".timeaxis."+i).on("ps-scroll-x",function(){return $(".timeline-container").scrollLeft($(this).scrollLeft())}),$(".timeline-container").on("ps-scroll-x",function(){return $(".timeaxis."+i).scrollLeft($(this).scrollLeft())})},m=function(){return $(".timeaxis."+i).off("ps-scroll-x"),$(".timeline-container").off("ps-scroll-x")},s=function(t,e){var n,r;return r=$(".xaxis .time-"+t[0]).parent().position().left-35,$(".statistics").css("left",r+"px"),n=parseInt($(".xaxis .time-"+t[0]).parents(".timeaxis").css("height").replace("px","")),$(".statistics").css("bottom",n+25+"px"),$(".statistics").addClass("visible"),$(".statistics ul li.incidents span.definition").text(e.incidents),$(".statistics ul li.casualties span.definition").text(e.casualties)},a=function(t,e){var n,r,o,a,s,l,u,c,d,p,h;if(e)for(_.includes(t,"dot")||t.push("dot","casualties"),c=$(".timeaxis."+i+" .ps-scrollbar-x-rail").attr("style"),c&&(n=parseInt(c.split("; ")[0].split(": ")[1].replace("px",""))),p=parseInt($(".time-"+t.join(".")).attr("cx"))+10-n,isNaN(p)&&(p=0),r={firstClasses:_.join(t,"."),secondClasses:_.join(t,"."),firstStat:"casualties",secondStat:"incidents"},_.includes(t,"incidents")&&(r.firstStat="incidents",r.secondStat="casualties"),r.secondClasses=_.replace(r.firstClasses,r.firstStat,r.secondStat),u=["first","second"],a=0,s=u.length;a<s;a++){if(l=u[a],o=$(".time-"+r[l+"Classes"]),0===o.length)return;h=$(".time-"+r[l+"Classes"]).position().top-60,d=r[l+"Stat"],$(".stats-"+d).css("top",h+"px"),$(".stats-"+d).css("left",p+"px"),$(".stats-"+d).addClass("visible"),$(".stats-"+d+" ul li."+d+" span.definition").text(e[d])}},c=function(){return $(".main-container").addClass("loading"),$(".overlay").addClass("visible")},g=function(){return $(".main-container").removeClass("loading"),$(".overlay").removeClass("visible")},u=function(){if($(".overlay .box").hasClass("visible"))return g(),$(".overlay .box").removeClass("visible")},t.prototype.highlight=function(t,e){return e||(e={incidents:0,casualties:0}),$(".timeline-container").hasClass("collapsed")?a(t,e):s(t,e)},t.prototype.unhighlight=function(t){return $(".statistics").removeClass("visible"),$(".statistics ul li.incidents span.definition").text("Loading..."),$(".statistics ul li.casualties span.definition").text("Loading..."),$(".stats-incidents").removeClass("visible"),$(".stats-casualties").removeClass("visible")},t.prototype.unfixHighlight=function(t){return $(".graph-slot p.selected-date span").text(l.getDateTextFragments().join(" ")),""===$(".graph-slot p.selected-date span").text().trim()&&$(".graph-slot p.selected-date").removeClass("visible"),m(),f(l.getDateState())},t.prototype.fixHighlight=function(t){return $(".graph-slot p.selected-date span").text(l.getDateTextFragments().join(" ")),$(".graph-slot p.selected-date").addClass("visible"),m(),f(d())},t.prototype.exploreDate=function(){return this.render(),h()},t.prototype.render=function(){return $(".xaxis-container ."+l.getDateState()).addClass("visible")},t.prototype.remove=function(t){var e,n,r;for(n=0,r=t.length;n<r;n++)e=t[n],$(".xaxis-container ."+e).removeClass("visible");return h()},t.prototype.redraw=function(){return y.printLog('{"listener.redraw()": "transitions function not implemented"}')},t.prototype.isLoading=function(){return c(),$(".overlay .loading").addClass("visible")},t.prototype.endLoading=function(){return g(),$(".overlay .loading").removeClass("visible")},t.prototype.translate=function(){var t;return t=moment.locale(),$(".graph-slot p.selected-date span").text(l.getDateTextFragments().join(" ")),$(".legend .for-incidents").text(sod_locale[t].incidents.label),$(".legend .for-casualties").text(sod_locale[t].casualties.label),$(".overlay .loading .label").text(sod_locale[t].loading.label),$(".menu .info .label").text(sod_locale[t].menu.info)},$(".graph-slot .toggle-timeline").click(function(){return $(this).children("p").children("i").toggleClass("fa-chevron-down"),$(this).children("p").children("i").toggleClass("fa-chevron-up"),$(".dates-container .xaxis-container").hasClass("collapsed")?($(".dates-container .xaxis-container").removeClass("collapsed"),$(".dates-container .xaxis-container").slideDown({duration:"slow",progress:function(t,n,r){return e(),l.shouldRedraw()}})):($(".dates-container .xaxis-container").addClass("collapsed"),$(".dates-container .xaxis-container").slideUp({duration:"slow",progress:function(t,n,r){return e(),l.shouldRedraw()}}))}),$(".breadcrumb-back").click(function(){var t,e,n;return t=["years","months","days"],n=$(".graph-slot p.selected-date span").text().trim().split(" "),e=n.length-1,l.shouldFixDate(n[e],t[e])}),$(".graph-slot .slot").click(function(){return p=parseInt($(".dates-container").css("height").replace("px","")),$(".timeline-container").hasClass("collapsed")?($(".timeline-container").removeClass("collapsed"),$(".timeline-container").slideUp({duration:"slow",progress:function(t,e,r){return n()}})):($(".timeline-container").addClass("collapsed"),$(".timeline-container").slideDown({duration:"slow",progress:function(t,e,r){return n()}}))}),$(".menu .info").on("click",function(){var t,e;return c(),e=moment.locale(),t=$(".overlay .box"),t.find(".headline").html(sod_locale[e].info.headline),t.find(".related").html(sod_locale[e].info.related),t.find(".footnote").html(sod_locale[e].info.footnote),t.addClass("visible")}),$(document).keyup(function(t){if(27===t.keyCode)return u()}),$(".overlay .box .close").on("click",function(){return u()}),$(window).resize(function(){return l.shouldRedraw()}),t}();var Map;Map=function(){function t(t){r=t,s()}var e,n,r,i,o,a,s,l,u,c,d;return d=new Utils,r=null,u=null,n=["years","months","days"],c=function(){return $(".dates-container .xaxis-container").height()},s=function(){return u=d3.select("body .map-container.fixed").append("div").attr("class","world-map-container").append("svg").attr("class","world-map").attr("viewBox","0 0 1000 730").attr("width","100%").attr("height",d.height+"px").call(d3.behavior.zoom().on("zoom",function(){return u.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")")})).append("g").attr("style","max-height: "+(d.height-c())+"px;")},o=d3.geo.mercator().translate([500,500]),i=d3.geo.path().projection(o),l=function(t){var e,i,o,a;if(i=d3.event.target.classList,_.indexOf(i,"years")!==-1&&(e=_.last(i),o=r.getDateState(),a=n.indexOf(o)-1,e===n[a]||e===o&&"days"===o))return t(i)},a=function(t){return e(),u.selectAll(".country").data(t.features).enter().append("path").attr("class",function(t){return"country "+t.id}).attr("d",i)},e=function(){return d3.select(".world-map-container").attr("style","padding-bottom: "+d.height+"px;")},t.prototype.highlight=function(t,e){var n,r,i,o,a;if(e){for(o=e.countries,a=[],r=0,i=o.length;r<i;r++)n=o[r],a.push(d3.select(".country."+n.country).classed("highlight",!0));return a}},t.prototype.unhighlight=function(t,e){var n,r,i,o,a;if(e){for(o=e.countries,a=[],r=0,i=o.length;r<i;r++)n=o[r],a.push(d3.select(".country."+n.country).classed("highlight",!1));return a}},t.prototype.unfixHighlight=function(t){var e,i,o,a,s;if("days"!==r.getDateState()){for(e=n.indexOf(t),s=[],i=o=a=e;a<=2?o<=2:o>=2;i=a<=2?++o:--o)s.push(u.selectAll(".country."+n[i]).classed(n[i],!1));return s}},t.prototype.fixHighlight=function(t,e){var n,i,o,a,s;if("days"!==r.getDateState()){for(a=e.countries,s=[],i=0,o=a.length;i<o;i++)n=a[i],s.push(u.select(".country."+n.country).classed(t,!0));return s}},t.prototype.exploreDate=function(){return u.attr("style","max-height: "+(d.height-c())+"px;")},t.prototype.render=function(t){return d.printLog('{"listener.render()": "map function not implemented"}')},t.prototype.draw=function(t){return d3.json("map.json",function(e,n){var r;return e?d.printLog(e):(r=topojson.feature(n,n.objects.world_map),a(r),t())})},t.prototype.remove=function(t){return d.printLog('{"listener.remove()": "map function not implemented"}')},t.prototype.redraw=function(){return e(),u.attr("style","max-height: "+(d.height-c())+"px;")},t.prototype.translate=function(){return d.printLog('{"listener.translate()": "map function not implemented"}')},t.prototype.isLoading=function(){return d.printLog('{"listener.isLoading()": "map function not implemented"}')},t.prototype.endLoading=function(){return d.printLog('{"listener.isLoading()": "map function not implemented"}')},t}();var Axis;Axis=function(){function t(){}var e,n,r;return r=new Utils,n=null,e=function(t,e){return t===e},t.prototype.setSvg=function(t){return n=d3.select("body .dates-container .xaxis-container ."+t.axisClass).append("svg").attr("class","xaxis").attr("width",t.width).attr("height",t.height).append("g")},t.prototype.getSvg=function(){return n},t.prototype.setScale=function(t){return d3.time.scale().range([0,t.width-100])},t.prototype.setAxis=function(t){return d3.svg.axis().scale(t).tickSize(0).tickPadding(5).orient("bottom")},t.prototype.configureAxisAndScale=function(t,e,n,i){return t.domain(d3.extent(n,function(t){return t.date})),e.ticks(d3.time[i]),e.tickFormat(function(t){return r.getFormattedDate(t,i)})},t.prototype.renderAxis=function(t,n,i,o){var a,s,l,u,c;for(u=t.append("g").attr("class","x axis").attr("transform","translate("+i.x0+", 0)").on("click",function(){var t,e,n;if(t=d3.event.target.classList,n=d3.event.target.parentElement.parentElement.parentElement.parentElement.parentElement.classList.value,!_.includes(t,"fix-unhighlight")&&!_.includes(n,"days"))return e=t[0].replace("time-",""),o.shouldFixDate(e,i.axisClass)}).on("mouseover",function(){var t;if(e(i.axisClass,o.getDateState()))return t=d3.event.target.classList,o.shouldHighlight(t)}).on("mouseout",function(){var t;if(e(i.axisClass,o.getDateState()))return t=d3.event.target.classList,o.shouldUnhighlight(t)}).call(n),s=d3.selectAll(".xaxis-container .timeaxis."+i.axisClass+" .x.axis .tick text")[0],a=0,l=s.length;a<l;a++)c=s[a],d3.select(c).attr("class",function(t){return"time-"+r.getFormattedDate(t,o.getDateState())});return u},t.prototype.toggleHighlight=function(t,e,n){return t.selectAll(".time-"+e).classed("highlight",n)},t.prototype.unfixHighlight=function(t,e){return t.selectAll(".tick text").classed("fix-unhighlight",!1),t.selectAll(".tick text").classed("fix-highlight",!1)},t.prototype.fixHighlight=function(t,e,n){var r;if(r=t.select(".tick text.fix-highlight.time-"+n),this.unfixHighlight(t,e),r.empty())return t.selectAll(".tick text").classed("fix-unhighlight",!0),t.select(".tick text.time-"+n).classed("fix-unhighlight",!1).classed("fix-highlight",!0)},t.prototype.translateAxis=function(t){var e,n,i,o,a;for(n=d3.selectAll(".xaxis-container .timeaxis."+t+" .x.axis .tick text")[0],o=[],e=0,i=n.length;e<i;e++)a=n[e],o.push(d3.select(a).attr("class",function(e){var n;return n=r.getFormattedDate(e,t),this.textContent=n,this.classList.value.replace(/time-\w*/g,"time-"+n)}));return o},t}();var Years;Years=function(){function t(t,r){n=r,i=t,s=e.setSvg(n)}var e,n,r,i,o,a,s,l,u;return e=new Axis,u=null,r=null,a=null,n=null,i=null,s=null,l=new Utils,o=function(){return i.getDateState()===n.axisClass},t.prototype.getScale=function(){return u},t.prototype.highlight=function(t){if(o())return e.toggleHighlight(s,t,!0)},t.prototype.unhighlight=function(t){if(o())return e.toggleHighlight(s,t,!1)},t.prototype.unfixHighlight=function(t){if(t===n.axisClass)return e.unfixHighlight(s,t)},t.prototype.fixHighlight=function(t){var r;if(t===n.axisClass)return i.endLoading(),r=i.getDateTextFragments()[0],e.fixHighlight(s,t,r)},t.prototype.exploreDate=function(){return l.printLog('{"listener.exploreDate()": "years function not implemented"}')},t.prototype.render=function(){if(o())return u=e.setScale(n),r=e.setAxis(u),e.configureAxisAndScale(u,r,i.getDataSet(),i.getDateState()),a=e.renderAxis(s,r,n,i)},t.prototype.remove=function(t){return l.printLog('{"listener.remove()": "years function not implemented"}')},t.prototype.redraw=function(){return l.printLog('{"listener.redraw()": "years function not implemented"}')},t.prototype.translate=function(){return l.printLog('{"listener.translate()": "years function not implemented"}')},t.prototype.isLoading=function(){return l.printLog('{"listener.isLoading()": "years function not implemented"}')},t.prototype.endLoading=function(){return l.printLog('{"listener.isLoading()": "years function not implemented"}')},t}();var Months;Months=function(){function t(t,r){n=r,i=t,s=e.setSvg(n)}var e,n,r,i,o,a,s,l,u;return e=new Axis,u=null,r=null,a=null,n=null,i=null,s=null,l=new Utils,o=function(){return i.getDateState()===n.axisClass},t.prototype.getScale=function(){return u},t.prototype.highlight=function(t){if(o())return e.toggleHighlight(s,t,!0)},t.prototype.unhighlight=function(t){if(o())return e.toggleHighlight(s,t,!1)},t.prototype.unfixHighlight=function(t){if(t===n.axisClass)return e.unfixHighlight(s,t)},t.prototype.fixHighlight=function(t){var r;if(t===n.axisClass)return i.endLoading(),r=i.getDateTextFragments()[1],e.fixHighlight(s,t,r)},t.prototype.exploreDate=function(){if(!a)return this.render()},t.prototype.render=function(){if(o())return u=e.setScale(n),r=e.setAxis(u),e.configureAxisAndScale(u,r,i.getDataSet(),i.getDateState()),a=e.renderAxis(s,r,n,i)},t.prototype.remove=function(t){if(t.indexOf(n.axisClass)!==-1)return a?(a.remove(),a=null):void 0},t.prototype.redraw=function(){return l.printLog('{"listener.redraw()": "months function not implemented"}')},t.prototype.translate=function(){return e.translateAxis("months")},t.prototype.isLoading=function(){return l.printLog('{"listener.isLoading()": "months function not implemented"}')},t.prototype.endLoading=function(){return l.printLog('{"listener.isLoading()": "months function not implemented"}')},t}();var Days;Days=function(){function t(t,r){n=r,i=t,s=e.setSvg(n)}var e,n,r,i,o,a,s,l,u;return e=new Axis,u=null,r=null,a=null,n=null,i=null,s=null,l=new Utils,o=function(){return i.getDateState()===n.axisClass},t.prototype.getScale=function(){return u},t.prototype.highlight=function(t){if(o())return e.toggleHighlight(s,t,!0)},t.prototype.unhighlight=function(t){if(o())return e.toggleHighlight(s,t,!1)},t.prototype.unfixHighlight=function(t){return l.printLog('{"listener.redraw()": "days function not implemented"}')},t.prototype.fixHighlight=function(t){return l.printLog('{"listener.redraw()": "days function not implemented"}')},t.prototype.exploreDate=function(){if(!a)return this.render()},t.prototype.render=function(){if(o())return u=e.setScale(n),r=e.setAxis(u),e.configureAxisAndScale(u,r,i.getDataSet(),i.getDateState()),a=e.renderAxis(s,r,n,i)},t.prototype.remove=function(t){if(t.indexOf(n.axisClass)!==-1)return a?(a.remove(),a=null):void 0},t.prototype.redraw=function(){return l.printLog('{"listener.redraw()": "days function not implemented"}')},t.prototype.translate=function(){return e.translateAxis("days")},t.prototype.isLoading=function(){return l.printLog('{"listener.isLoading()": "days function not implemented"}')},t.prototype.endLoading=function(){return l.printLog('{"listener.isLoading()": "days function not implemented"}')},t}();var Dots;Dots=function(){function t(t,e,n){var r,i;a=e,u=n,p=t,i=a.height/2,r=a.height,f=d3.scale.linear().range([r-20,i+20]),g=d3.scale.linear().range([i-20,50])}var e,n,r,i,o,a,s,l,u,c,d,p,h,f,g;return h=new Utils,o=null,i=null,d=null,c=null,g=null,f=null,p=null,u=null,a={height:0,xHeight:0,x0:0},r=function(){return g.domain([0,d3.max(u.getDataSet(),function(t){return t.incidents})]),f.domain([0,d3.max(u.getDataSet(),function(t){return t.casualties})])},n=function(t){return d3.svg.axis().scale(t).orient("left").tickSize(2).ticks(5).tickFormat(function(t){switch(!1){case!(t>99):return(t/1e3).toString().replace(/^0\./,".")+"K";case!(t>99e3):return(t/1e6).toString().replace(/^0\./,".")+"M";default:return t}})},l=function(t,e,n){return p.getSvg().append("path").datum(u.getDataSet()).attr("class","line-chart "+e).attr("d",t).attr("transform","translate("+a.x0+", 0)"),p.getSvg().append("g").attr("class","yaxis").attr("transform","translate(40, 0)").call(n)},s=function(t,e,n,r,i){return t.append("circle").attr("class",function(t){var e;return e=h.getFormattedDate(t.date,u.getDateState()),"time-"+e+" dot "+n}).attr("r",r).attr("cx",function(t){return e(t.date)}).attr("cy",function(t){return i(t)}).attr("transform","translate("+a.x0+", 0)").on("click",function(t){var e;return e=d3.event.target.classList[0].replace("time-",""),u.shouldFixDate(e,u.getDateState())}).on("mouseover",function(t){var e;return e=d3.event.target.classList,u.shouldHighlight(e)}).on("mouseout",function(t){var e;return e=d3.event.target.classList,u.shouldUnhighlight(e)})},e=function(t,e,n){return d3.svg.line().x(function(e){return t(e.date)}).y(function(t){return e(t[n])})},t.prototype.remove=function(){return o&&o.remove(),i&&i.remove(),d&&d.remove(),c&&c.remove(),p.getSvg().selectAll("path").remove()},t.prototype.draw=function(t,a){var u,p,h;return r(),u=6,p=n(f),h=n(g),c=l(e(a,f,"casualties"),"casualties",p),i=s(t,a,"casualties",u,function(t){return f(t.casualties)}),d=l(e(a,g,"incidents"),"incidents",h),o=s(t,a,"incidents",u,function(t){return g(t.incidents)})},t}();var Timeline;Timeline=function(){function t(t,n,o){var a;i=o,u=n,s(),a={height:u.height,xHeight:p,x0:u.x0},r=new Dots(this,a,i),e=t}var e,n,r,i,o,a,s,l,u,c,d,p,h;return d=new Utils,r=null,e=null,i=null,h=null,o=null,l=null,u={height:0,width:0,x0:0},p=50,s=function(){return l=d3.select("body .dates-container .timeline-container").attr("style",d.sizeStyles(u.width,"auto")).append("svg").attr("class","timeline").attr("width",u.width).attr("height",u.height).append("g")},c=function(t,e){var n;if(t)return n=d.getFormattedDate(t.date,i.getDateState()),l.selectAll(".time-"+n).classed("highlight",e)},n=function(){return h.domain(d3.extent(i.getDataSet(),function(t){return t.date}))},a=function(){var t;return r.remove(),h=e.getScale(),n(),t=l.selectAll("dot").data(i.getDataSet()).enter(),r.draw(t,h)},t.prototype.getSvg=function(){return l},t.prototype.highlight=function(t,e){return c(e,!0)},t.prototype.unhighlight=function(t,e){return c(e,!1)},t.prototype.unfixHighlight=function(t){return d.printLog('{"listener.fixHighlight(dataSet)": "timeline function not implemented"}')},t.prototype.fixHighlight=function(t){return d.printLog('{"listener.fixHighlight(dataSet)": "timeline function not implemented"}')},t.prototype.exploreDate=function(t){return a()},t.prototype.render=function(){return a()},t.prototype.remove=function(){return d.printLog('{"listener.remove()": "timeline function not implemented"}')},t.prototype.redraw=function(){return d.printLog('{"listener.redraw()": "timeline function not implemented"}')},t.prototype.translate=function(){return d.printLog('{"listener.translate()": "timeline function not implemented"}')},t.prototype.isLoading=function(){return d.printLog('{"listener.isLoading()": "timeline function not implemented"}');
},t.prototype.endLoading=function(){return d.printLog('{"listener.isLoading()": "timeline function not implemented"}')},t}();var MainController,mainController;MainController=function(){function t(){r.addListener(o),r.addListener(h),r.addListener(a),r.addListener(e),r.addListener(c),r.addListener(l)}var e,n,r,i,o,a,s,l,u,c,d,p,h,f;return d=new UrlManager,r=new EventsManager(d),p=new Utils,c=new Transitions(r),o=new Map(r),f={width:3e3,height:50,x0:50,y0:0,axisClass:"years"},h=new Years(r,f),s={width:3e3,height:50,x0:50,y0:0,axisClass:"months"},a=new Months(r,s),n={width:3e3,height:50,x0:50,y0:0,axisClass:"days"},e=new Days(r,n),u={width:3e3,height:p.timelineHeight,x0:60},l=new Timeline(h,u,r),i=new LocaleUI("en",r),t.prototype.draw=function(){return o.draw(function(){return r.shouldRender()})},t}(),mainController=new MainController,mainController.draw();
